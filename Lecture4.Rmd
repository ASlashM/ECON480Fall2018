---
title: "Lecture 4: Random Variables"
subtitle: "ECON 480 - Econometrics - Fall 2018"
author: "Ryan Safner"
date: "September 10, 2018"
output: 
  beamer_presentation:
    #theme: "metropolis"
    incremental: true 
    fig_caption: yes
    toc: true 
    slide_level: 3
    includes:
      in_header: header.tex
    keep_tex: no 
    latex_engine: xelatex #required for Fira Sans font to render properly 

classoption: aspectratio=169
#fontsize:bigger
---

```{r setup, include=FALSE}
# For making transparent ggplot2 graphs, from https://gist.github.com/cboettig/5600558 

# Set plotting to bw plot default, but with transparent background elements.  
# Note transparency requires the panel.background, plot.background, and device background all be set!
library(ggplot2) 
theme_set(theme_bw(base_size=12))
theme_update(panel.background = element_rect(fill = "transparent", colour = NA),
             plot.background = element_rect(fill = "transparent", colour = NA))
knitr::opts_chunk$set(dev.args=list(bg="transparent"))
```

# Random Variables

### Experiments

- An \alert{experiment} is any procedure that can (in principle) be repeated infinitely and has a well-defined set of outcomes

\begin{example}
Flip a coin 10 times
\end{example}

\begin{figure}
	\includegraphics[height=1.5in]{headstails}	
\end{figure}

### Random Variables

- A \alert{random variable (RV)} takes on values that are unknown in advance, but determined by an experiment
- A R.V. is a numerical summary of a random outcome 

\begin{example}
The number of Heads from 10 coin flips
\end{example}

\begin{figure}
	\includegraphics[height=1.5in]{headstails}	
\end{figure}

### Random Variables: Notation

- Random variable $X$ takes on individual values ($X_i$) from a set of possible values 
- Often capital letters to denote RV's

\begin{example}
Let $X$ be the number of Heads from 10 coin flips. $x_i \in \{0, 1, 2,...,10\}$
\end{example}

## Discrete Random Variables 

### Discrete Random Variables

- A \alert{discrete random variable} takes on a finite/countable set of possible values

\begin{example}
	Let $X$ be the number of times your computer crashes this semester, $x_i \in \{0, 1, 2, 3, 4\}$
\end{example}

\begin{figure}
		\includegraphics[height=1.75in]{bluescreen}	
\end{figure}

### Discrete Random Variables: Probability Distribution

- The \alert{probability distribution} of a R.V. fully lists all the possible values of $X$ and their associated probabilities

\begin{example}
		\begin{table}
		\begin{tabular}{cc}
		$x_i$ & $P(X=x_i)$\\ \toprule 
		0 & 0.80\\
		1 & 0.10\\
		2 & 0.06\\
		3 & 0.03\\
		4 & 0.01\\ \bottomrule 
		\end{tabular}
	\end{table}	
\end{example} 

### Discrete Random Variables: PDF

- The \alert{probability distribution function (pdf)} summarizes the possible outcomes of $X$ and their probabilities
- Notation: $f_X$ is the pdf of $X$: 

$$f_X=p_i, i=1,2,...,k$$

- For any real number $x_i$, $f(x_i)$ is the probablity that $X=x_i$

### Discrete Random Variables: PDF Example

\begin{example}
		\begin{table}
		\begin{tabular}{cc}
		$x_i$ & $P(X=x_i)$\\ \toprule 
		0 & 0.80\\
		1 & 0.10\\
		2 & 0.06\\
		3 & 0.03\\
		4 & 0.01\\ \bottomrule 
		\end{tabular}
	\end{table}	
	\begin{itemize}
	  \item<2-> What is $f(0)$?
	  \item<3-> What is $f(3)$?
	\end{itemize} 
\end{example} 

### Discrete Random Variables: PDF Graph

```{r discrete pdf}
crashes<-c(0,1,2,3,4)
prob<-c(0.8,0.1,0.06,0.03,0.01)
crashes<-data.frame(crashes, prob)

crashes.pdf<-ggplot(crashes, aes(x=crashes, y=prob))+
  geom_bar(stat="identity", fill="#0072B2")+xlab("Crashes")+ylab("Probability")

crashes.pdf
```

### Discrete Random Variables: CDF

- The \alert{\emph{cumulative} density function (cdf)} describes the probability that $X$ will be *at most* (less than or equal to) a given value $x_i$
- Notation: $F_X=P(X \leq x_i)$

\begin{example}
		\begin{table}
		\begin{tabular}{ccc}
		$x_i$ & $f(x)$ & $F(X)$\\ \toprule 
		0 & 0.80 & 0.80\\
		1 & 0.10 & 0.90\\
		2 & 0.06 & 0.96\\
		3 & 0.03 & 0.99\\
		4 & 0.01 & 1.00\\ \bottomrule 
		\end{tabular}
	\end{table}	
	\begin{itemize}
	  \item <3-> What is the probability your computer will crash at most once? $F(1)$?
	  \item <4-> What is the probability your computer will crash at most three times? $F(3)$?
	 \end{itemize}
\end{example} 

### Discrete Random Variables: CDF Graph

```{r discrete cdf}
crashes$cprob<-(cumsum(crashes$prob))

crashes.cdf<-ggplot(crashes, aes(x=crashes, y=cprob))+
  geom_bar(stat="identity", fill="#0072B2")+xlab("Crashes")+ylab("Cumulative Probability")

crashes.cdf

```

## Expected Value and Variance

### Expected Value of a Random Variable

- The \alert{expected value} of a random variable $X$, written $E(X)$, is the long-run average value of $X$ "expected" after many repetitions

\onslide<3->\begin{equation*}
E(X)= p_1x_1+p_2x_2+...+p_kx_k \onslide<4->= \displaystyle \sum^k_{i=1} p_i x_i
\end{equation*}

- A probability-weighted average of $X$, with each $x_i$ weighted by its associated probability $p_i$
- Also called the \alert{mean} or \alert{expectation} of $X$, also denoted $\mu_X$

### Expected Value: Example

\begin{example}	
Suppose you lend your friend \$100 at 10\% interest. If the loan is repaid, you receive \$110	. Your friend is 99\% likely to repay, but there is a default risk of 1\% where you get nothing. What is the expected value of repayment? 
\end{example}

### Expected Value: Example II

\begin{example}
	Let $X$ be a random variable that is described by the following pdf:
	\begin{table}
	\begin{tabular}{cccc}
	$x_i$ & $P(X=x_i)$\\ \toprule
	1 & 0.50\\
	2 & 0.25\\
	3 & 0.10\\
	4 & 0.05\\ \bottomrule 	
	\end{tabular}
	\end{table}
	\begin{itemize}
		\item What is $E(X)$?
	\end{itemize}
\end{example}

### Variance of a Random Variable

- The \alert{variance} of a random variable $X$, denoted $var(X)$ or $\sigma^2_X$ is:

\begin{equation*}
		\sigma^2_X = \sum_{i=1}^n(x_i-\mu_X)^2p_i \onslide<3-> = E[(X-\mu_X)^2]	
\end{equation*}

- This is the expected value of the squared deviations from the mean
    - i.e. the probability-weighted average of the squared deviations 

### Standard Deviation of a Random Variable

- The \alert{standard deviation} of a random variable $X$, denoted $sd(X)$ or $\sigma_X$ is:

$$\sigma_X=\sqrt{\sigma_X^2}$$

### Standard Deviation: Example

\begin{example}
	What is the standard deviation of computer crashes? 
		\begin{table}
		\begin{tabular}{cccccc}
		& \multicolumn{5}{c}{Number of Computer Crashes}\\ \cmidrule{2-6}
				$x_i$ & 0 & 1 & 2 & 3 & 4\\ \toprule 
				$P(X=x_i)$ & 0.80 & 0.10 & 0.06 & 0.03 & 0.01\\ \bottomrule 
		\end{tabular}
	\end{table}	
	\begin{itemize}
	  \item<2-> First, calculate the mean: 
	  \begin{align*}
	  E(X)&=0(0.80)+1(0.10)+2(0.06)+3(0.03)+4(0.01)\\
	  &=0+0.1+0.12+0.09+0.04\\
	  &=0.35\\
	  \end{align*}
	\end{itemize}
\end{example} 

### Standard Deviation: Example II

\begin{example}
	What is the standard deviation of computer crashes? 
	\begin{itemize}
	  \item<2-> Next, find the deviations from the mean and square them: 
				\begin{tabular}{cccccc}
		& \multicolumn{5}{c}{Number of Crashes ($E(X)=0.35$)}\\ \cmidrule{2-6}
				$x_i$ & 0 & 1 & 2 & 3 & 4\\ \toprule 
				$P(X=x_i)$ & 0.80 & 0.10 & 0.06 & 0.03 & 0.01\\ 
				$(x_i-E(X))$ & -0.35 & 0.65 & 1.65 & 2.65 & 3.65\\  
				$(x_i-E(X)$ & 0.1225 & 0.4225 & 2.7225 & 7.0225 & 13.3225\\ \bottomrule 
		\end{tabular}
		\item<3-> Take the expectation of the squared deviations to get variance
			\scriptsize \begin{align*}
	\sigma^2_X &= 0.1225(0.80)+0.4225(0.10)+2.7225(0.06)+7.0225(0.03)+13.3225(0.01)\\
	&=0.098+0.04225+0.16335+0.210675+0.133225\\
	&=0.6475 \\ 
	\end{align*}
  \end{itemize}
\end{example}

### Standard Deviation: Example III 
\begin{example}
	What is the standard deviation of computer crashes? 
	\begin{itemize}
		\item To get standard deviation, $\sigma$, take the square root:
	\begin{align*}
		\sigma=\sqrt{\sigma^2}\\
		&=\sqrt{0.6475}\\
		&=0.8047\\
	\end{align*}
	\end{itemize}
\end{example} 

## Continuous Random Variables

### Continuous Random Variables

- \alert{\emph{Continuous} random variables} can take on an uncountable (infinite) number of values
- So many values that the probability of any specific value is infinitely small $\rightarrow$ 0.
- Instead, we focus on a *range* of values it might take on

\begin{figure}
		\includegraphics[height=1.5in]{continuous}	
\end{figure}	

### Continuous Random Variable PDF

- The \alert{probability \emph{density} function (pdf)} of a continuous variable represents the probability between two values as the area under a curve
- The total area under the curve is 1
- Since $P(a)=0$ and $P(b)=0$, $P(a<X<b)=P(a \leq X \leq b)$


\begin{figure}
		\centering 	
		\begin{tikzpicture}
\begin{axis}[
  no markers, domain=-4:4, samples=100,
  axis lines*=left, xlabel=$X$, ylabel={},
  every axis y label/.style={at=(current axis.above origin),anchor=south},
  every axis x label/.style={at=(current axis.right of origin),anchor=west},
  height=5cm, width=10cm,
  xtick={-4, -3, -2, -1, 0, 1, 2, 3, 4}, ytick=\empty,
  enlargelimits=false, clip=false, axis on top,
  grid = none
  ]
  \addplot [fill=red!50, draw=none, domain=-1:1] {gauss(0,1)} \closedcycle;
  \addplot [very thick,cyan!50!black] {gauss(0,1)};
\end{axis}
\end{tikzpicture}
\caption*{P($-1 \leq X \leq 1$): area under the curve between -1 and 1.} 
\end{figure}

### Continuous Random Variable PDF

- FYI using calculus:

$$P(a \leq X \leq b) = \int_a^b f(x) dx $$

- These functions are complicated: we have software or (old fashioned!) probability tables to calculate

```{r continuous pdf, echo=FALSE}

funcShaded <- function(x) {
    y <- dnorm(x, mean = 0, sd = 1)
    y[x < -1 | x >1] <- NA
    return(y)
}

continuous.pdf<-ggplot(data.frame(x=-4:4),aes(x=x))+
    stat_function(fun=dnorm, args=list(mean=0, sd=1), color="blue")+
    stat_function(fun=funcShaded, geom="area", fill="#84CA72", alpha=0.5)+
    xlab("x")+ylab("p(x)")
continuous.pdf
```

### Continuous Random Variable CDF

- The \alert{\emph{cumulative} density function (cdf)} describes the area under the pdf for all values less than or equal to (i.e. to the left of) a given value, $k$
$$P(X \leq k)$$ 

```{r continuous cdf shaded L, echo=FALSE}

cdfshadedL <- function(x) {
    y <- pnorm(x, mean = 0, sd = 1)
    y[x < -4 | x >1] <- NA
    return(y)
}

continuous.pdf<-ggplot(data.frame(x=-4:4),aes(x=x))+
    stat_function(fun=pnorm, args=list(mean=0, sd=1), color="blue")+
    stat_function(fun=cdfshadedL, geom="area", fill="#84CA72", alpha=0.5)+
    xlab("x")+ylab("p(x)")
continuous.pdf
```

### Continuous Random Variable CDF II

- Note: to find the probability of values *greater* than or equal to (to the right of) a given value $k$:
$$P(X \geq k)=1-P(X \leq k)$$

```{r continuous cdf shaded R, echo=FALSE}

cdfshadedR <- function(x) {
    y <- pnorm(x, mean = 0, sd = 1)
    y[x < 1 | x >4] <- NA
    return(y)
}

continuous.pdf<-ggplot(data.frame(x=-4:4),aes(x=x))+
    stat_function(fun=pnorm, args=list(mean=0, sd=1), color="blue")+
      stat_function(fun=cdfshadedR, geom="area", fill="#84CA72", alpha=0.5)+
    xlab("x")+ylab("p(x)")
continuous.pdf
```

## Normal Distribution

### The Normal Distribution

- The \alert{Gaussian} or \alert{normal distribution} is the most common type of probability distribution, and we make extensive use of it

$$ X \sim N(\mu,\sigma)$$

- Continuous, symmetric, unimodal, with mean $\mu$ and standard deviation $\sigma$

```{r normal pdf, echo=FALSE}

normal.pdf<-ggplot(data.frame(x=-4:4),aes(x=x))+
    stat_function(fun=dnorm, args=list(mean=0, sd=1), color="blue")+
    xlab("x")+ylab("p(x)")
normal.pdf
```

### The Normal PDF

- The pdf of $X \sim N(\mu, \sigma)$ is 
$$P(X=k)=	\frac{1}{\sqrt{2\pi \sigma^2}}e^{-\frac{1}{2}\big(\frac{(k-\mu)}{\sigma}\big)^2}$$ 
- **Do not try and learn this**, we have software and (previously tables) to calculate pdfs and cdfs

```{r calculate normal}
# Find probability that a student earns at least an 80 if
#the average grade is a 75 and standard deviation is 10

#lower.tail is TRUE if calculating area to LEFT of 80, 
#FALSE if to the RIGHT
pnorm(80, mean=72, sd=10, lower.tail=FALSE) 
```

### The Effect Parameter Changes

- The pdf moves left/right based on $\mu$
- The pdf gets fatter/skinnier based on $\sigma$

```{r normal pdf changes, echo=FALSE, warning=FALSE}

normals.pdf<-ggplot(data.frame(x=-4:4),aes(x=x))+
    stat_function(fun=dnorm, args=list(mean=0, sd=1), aes(color = "E(X)=0, sd(X)=1"))+
    stat_function(fun=dnorm, args=list(mean=0, sd=2), aes(color = "E(X)=0, sd(X)=2"))+
    stat_function(fun=dnorm, args=list(mean=0, sd=0.5), aes(color = "E(X)=0, sd(X)=0.5"))+
    stat_function(fun=dnorm, args=list(mean=2, sd=1), aes(color = "E(X)=2, sd(X)=1"))+
    stat_function(fun=dnorm, args=list(mean=-2, sd=1), aes(color = "E(X)=-2, sd(X)=1"))+
    #scale_colour_manual("Legend")+#, values = c("red", "blue", "green", "orange", "purple"))+
    xlab("x")+ylab("p(x)")
normals.pdf
```

